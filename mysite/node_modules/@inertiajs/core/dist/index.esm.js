import{default as _}from"axios";function T(t,e){let r;return function(...i){clearTimeout(r),r=setTimeout(()=>t.apply(this,i),e)}}function m(t,e){return document.dispatchEvent(new CustomEvent(`inertia:${t}`,e))}var H=t=>m("before",{cancelable:!0,detail:{visit:t}}),j=t=>m("error",{detail:{errors:t}}),q=t=>m("exception",{cancelable:!0,detail:{exception:t}}),O=t=>m("finish",{detail:{visit:t}}),$=t=>m("invalid",{cancelable:!0,detail:{response:t}}),w=t=>m("navigate",{detail:{page:t}}),W=t=>m("progress",{detail:{progress:t}}),B=t=>m("start",{detail:{visit:t}}),K=t=>m("success",{detail:{page:t}});function L(t){return t instanceof File||t instanceof Blob||t instanceof FileList&&t.length>0||t instanceof FormData&&Array.from(t.values()).some(e=>L(e))||typeof t=="object"&&t!==null&&Object.values(t).some(e=>L(e))}function k(t,e=new FormData,r=null){t=t||{};for(let i in t)Object.prototype.hasOwnProperty.call(t,i)&&J(e,X(r,i),t[i]);return e}function X(t,e){return t?t+"["+e+"]":e}function J(t,e,r){if(Array.isArray(r))return Array.from(r.keys()).forEach(i=>J(t,X(e,i.toString()),r[i]));if(r instanceof Date)return t.append(e,r.toISOString());if(r instanceof File)return t.append(e,r,r.name);if(r instanceof Blob)return t.append(e,r);if(typeof r=="boolean")return t.append(e,r?"1":"0");if(typeof r=="string")return t.append(e,r);if(typeof r=="number")return t.append(e,`${r}`);if(r==null)return t.append(e,"");k(r,t,e)}var z={modal:null,listener:null,show(t){typeof t=="object"&&(t=`All Inertia requests must receive a valid Inertia response, however a plain JSON response was received.<hr>${JSON.stringify(t)}`);let e=document.createElement("html");e.innerHTML=t,e.querySelectorAll("a").forEach(i=>i.setAttribute("target","_top")),this.modal=document.createElement("div"),this.modal.style.position="fixed",this.modal.style.width="100vw",this.modal.style.height="100vh",this.modal.style.padding="50px",this.modal.style.boxSizing="border-box",this.modal.style.backgroundColor="rgba(0, 0, 0, .6)",this.modal.style.zIndex=2e5,this.modal.addEventListener("click",()=>this.hide());let r=document.createElement("iframe");if(r.style.backgroundColor="white",r.style.borderRadius="5px",r.style.width="100%",r.style.height="100%",this.modal.appendChild(r),document.body.prepend(this.modal),document.body.style.overflow="hidden",!r.contentWindow)throw new Error("iframe not yet ready.");r.contentWindow.document.open(),r.contentWindow.document.write(e.outerHTML),r.contentWindow.document.close(),this.listener=this.hideOnEscape.bind(this),document.addEventListener("keydown",this.listener)},hide(){this.modal.outerHTML="",this.modal=null,document.body.style.overflow="visible",document.removeEventListener("keydown",this.listener)},hideOnEscape(t){t.keyCode===27&&this.hide()}};var A=(n=>(n.GET="get",n.POST="post",n.PUT="put",n.PATCH="patch",n.DELETE="delete",n))(A||{});import re from"deepmerge";import*as C from"qs";function g(t){return new URL(t.toString(),window.location.toString())}function F(t,e,r,i="brackets"){let s=/^https?:\/\//.test(e.toString()),n=s||e.toString().startsWith("/"),u=!n&&!e.toString().startsWith("#")&&!e.toString().startsWith("?"),f=e.toString().includes("?")||t==="get"&&Object.keys(r).length,b=e.toString().includes("#"),l=new URL(e.toString(),"http://localhost");return t==="get"&&Object.keys(r).length&&(l.search=C.stringify(re(C.parse(l.search,{ignoreQueryPrefix:!0}),r),{encodeValuesOnly:!0,arrayFormat:i}),r={}),[[s?`${l.protocol}//${l.host}`:"",n?l.pathname:"",u?l.pathname.substring(1):"",f?l.search:"",b?l.hash:""].join(""),r]}function x(t){return t=new URL(t.href),t.hash="",t}var Q=typeof window>"u",N=class{constructor(){this.visitId=null}init({initialPage:e,resolveComponent:r,swapComponent:i}){this.page=e,this.resolveComponent=r,this.swapComponent=i,this.setNavigationType(),this.clearRememberedStateOnReload(),this.isBackForwardVisit()?this.handleBackForwardVisit(this.page):this.isLocationVisit()?this.handleLocationVisit(this.page):this.handleInitialPageVisit(this.page),this.setupEventListeners()}setNavigationType(){this.navigationType=window.performance&&window.performance.getEntriesByType("navigation").length>0?window.performance.getEntriesByType("navigation")[0].type:"navigate"}clearRememberedStateOnReload(){this.navigationType==="reload"&&window.history.state?.rememberedState&&delete window.history.state.rememberedState}handleInitialPageVisit(e){this.page.url+=window.location.hash,this.setPage(e,{preserveState:!0}).then(()=>w(e))}setupEventListeners(){window.addEventListener("popstate",this.handlePopstateEvent.bind(this)),document.addEventListener("scroll",T(this.handleScrollEvent.bind(this),100),!0)}scrollRegions(){return document.querySelectorAll("[scroll-region]")}handleScrollEvent(e){typeof e.target.hasAttribute=="function"&&e.target.hasAttribute("scroll-region")&&this.saveScrollPositions()}saveScrollPositions(){this.replaceState({...this.page,scrollRegions:Array.from(this.scrollRegions()).map(e=>({top:e.scrollTop,left:e.scrollLeft}))})}resetScrollPositions(){window.scrollTo(0,0),this.scrollRegions().forEach(e=>{typeof e.scrollTo=="function"?e.scrollTo(0,0):(e.scrollTop=0,e.scrollLeft=0)}),this.saveScrollPositions(),window.location.hash&&setTimeout(()=>document.getElementById(window.location.hash.slice(1))?.scrollIntoView())}restoreScrollPositions(){this.page.scrollRegions&&this.scrollRegions().forEach((e,r)=>{let i=this.page.scrollRegions[r];if(i)typeof e.scrollTo=="function"?e.scrollTo(i.left,i.top):(e.scrollTop=i.top,e.scrollLeft=i.left);else return})}isBackForwardVisit(){return window.history.state&&this.navigationType==="back_forward"}handleBackForwardVisit(e){window.history.state.version=e.version,this.setPage(window.history.state,{preserveScroll:!0,preserveState:!0}).then(()=>{this.restoreScrollPositions(),w(e)})}locationVisit(e,r){try{let i={preserveScroll:r};window.sessionStorage.setItem("inertiaLocationVisit",JSON.stringify(i)),window.location.href=e.href,x(window.location).href===x(e).href&&window.location.reload()}catch{return!1}}isLocationVisit(){try{return window.sessionStorage.getItem("inertiaLocationVisit")!==null}catch{return!1}}handleLocationVisit(e){let r=JSON.parse(window.sessionStorage.getItem("inertiaLocationVisit")||"");window.sessionStorage.removeItem("inertiaLocationVisit"),e.url+=window.location.hash,e.rememberedState=window.history.state?.rememberedState??{},e.scrollRegions=window.history.state?.scrollRegions??[],this.setPage(e,{preserveScroll:r.preserveScroll,preserveState:!0}).then(()=>{r.preserveScroll&&this.restoreScrollPositions(),w(e)})}isLocationVisitResponse(e){return!!(e&&e.status===409&&e.headers["x-inertia-location"])}isInertiaResponse(e){return!!e?.headers["x-inertia"]}createVisitId(){return this.visitId={},this.visitId}cancelVisit(e,{cancelled:r=!1,interrupted:i=!1}){e&&!e.completed&&!e.cancelled&&!e.interrupted&&(e.cancelToken.abort(),e.onCancel(),e.completed=!1,e.cancelled=r,e.interrupted=i,O(e),e.onFinish(e))}finishVisit(e){!e.cancelled&&!e.interrupted&&(e.completed=!0,e.cancelled=!1,e.interrupted=!1,O(e),e.onFinish(e))}resolvePreserveOption(e,r){return typeof e=="function"?e(r):e==="errors"?Object.keys(r.props.errors||{}).length>0:e}cancel(){this.activeVisit&&this.cancelVisit(this.activeVisit,{cancelled:!0})}visit(e,{method:r="get",data:i={},replace:s=!1,preserveScroll:n=!1,preserveState:u=!1,only:f=[],headers:b={},errorBag:l="",forceFormData:c=!1,onCancelToken:v=()=>{},onBefore:R=()=>{},onStart:d=()=>{},onProgress:p=()=>{},onFinish:V=()=>{},onCancel:y=()=>{},onSuccess:D=()=>{},onError:U=()=>{},queryStringArrayFormat:I="brackets"}={}){let P=typeof e=="string"?g(e):e;if((L(i)||c)&&!(i instanceof FormData)&&(i=k(i)),!(i instanceof FormData)){let[o,a]=F(r,P,i,I);P=g(o),i=a}let S={url:P,method:r,data:i,replace:s,preserveScroll:n,preserveState:u,only:f,headers:b,errorBag:l,forceFormData:c,queryStringArrayFormat:I,cancelled:!1,completed:!1,interrupted:!1};if(R(S)===!1||!H(S))return;this.activeVisit&&this.cancelVisit(this.activeVisit,{interrupted:!0}),this.saveScrollPositions();let M=this.createVisitId();this.activeVisit={...S,onCancelToken:v,onBefore:R,onStart:d,onProgress:p,onFinish:V,onCancel:y,onSuccess:D,onError:U,queryStringArrayFormat:I,cancelToken:new AbortController},v({cancel:()=>{this.activeVisit&&this.cancelVisit(this.activeVisit,{cancelled:!0})}}),B(S),d(S),_({method:r,url:x(P).href,data:r==="get"?{}:i,params:r==="get"?i:{},signal:this.activeVisit.cancelToken.signal,headers:{...b,Accept:"text/html, application/xhtml+xml","X-Requested-With":"XMLHttpRequest","X-Inertia":!0,...f.length?{"X-Inertia-Partial-Component":this.page.component,"X-Inertia-Partial-Data":f.join(",")}:{},...l&&l.length?{"X-Inertia-Error-Bag":l}:{},...this.page.version?{"X-Inertia-Version":this.page.version}:{}},onUploadProgress:o=>{i instanceof FormData&&(o.percentage=o.progress?Math.round(o.progress*100):0,W(o),p(o))}}).then(o=>{if(!this.isInertiaResponse(o))return Promise.reject({response:o});let a=o.data;f.length&&a.component===this.page.component&&(a.props={...this.page.props,...a.props}),n=this.resolvePreserveOption(n,a),u=this.resolvePreserveOption(u,a),u&&window.history.state?.rememberedState&&a.component===this.page.component&&(a.rememberedState=window.history.state.rememberedState);let E=P,G=g(a.url);return E.hash&&!G.hash&&x(E).href===G.href&&(G.hash=E.hash,a.url=G.href),this.setPage(a,{visitId:M,replace:s,preserveScroll:n,preserveState:u})}).then(()=>{let o=this.page.props.errors||{};if(Object.keys(o).length>0){let a=l?o[l]?o[l]:{}:o;return j(a),U(a)}return K(this.page),D(this.page)}).catch(o=>{if(this.isInertiaResponse(o.response))return this.setPage(o.response.data,{visitId:M});if(this.isLocationVisitResponse(o.response)){let a=g(o.response.headers["x-inertia-location"]),E=P;E.hash&&!a.hash&&x(E).href===a.href&&(a.hash=E.hash),this.locationVisit(a,n===!0)}else if(o.response)$(o.response)&&z.show(o.response.data);else return Promise.reject(o)}).then(()=>{this.activeVisit&&this.finishVisit(this.activeVisit)}).catch(o=>{if(!_.isCancel(o)){let a=q(o);if(this.activeVisit&&this.finishVisit(this.activeVisit),a)return Promise.reject(o)}})}setPage(e,{visitId:r=this.createVisitId(),replace:i=!1,preserveScroll:s=!1,preserveState:n=!1}={}){return Promise.resolve(this.resolveComponent(e.component)).then(u=>{r===this.visitId&&(e.scrollRegions=e.scrollRegions||[],e.rememberedState=e.rememberedState||{},i=i||g(e.url).href===window.location.href,i?this.replaceState(e):this.pushState(e),this.swapComponent({component:u,page:e,preserveState:n}).then(()=>{s||this.resetScrollPositions(),i||w(e)}))})}pushState(e){this.page=e,window.history.pushState(e,"",e.url)}replaceState(e){this.page=e,window.history.replaceState(e,"",e.url)}handlePopstateEvent(e){if(e.state!==null){let r=e.state,i=this.createVisitId();Promise.resolve(this.resolveComponent(r.component)).then(s=>{i===this.visitId&&(this.page=r,this.swapComponent({component:s,page:r,preserveState:!1}).then(()=>{this.restoreScrollPositions(),w(r)}))})}else{let r=g(this.page.url);r.hash=window.location.hash,this.replaceState({...this.page,url:r.href}),this.resetScrollPositions()}}get(e,r={},i={}){return this.visit(e,{...i,method:"get",data:r})}reload(e={}){return this.visit(window.location.href,{...e,preserveScroll:!0,preserveState:!0})}replace(e,r={}){return console.warn(`Inertia.replace() has been deprecated and will be removed in a future release. Please use Inertia.${r.method??"get"}() instead.`),this.visit(e,{preserveState:!0,...r,replace:!0})}post(e,r={},i={}){return this.visit(e,{preserveState:!0,...i,method:"post",data:r})}put(e,r={},i={}){return this.visit(e,{preserveState:!0,...i,method:"put",data:r})}patch(e,r={},i={}){return this.visit(e,{preserveState:!0,...i,method:"patch",data:r})}delete(e,r={}){return this.visit(e,{preserveState:!0,...r,method:"delete"})}remember(e,r="default"){Q||this.replaceState({...this.page,rememberedState:{...this.page?.rememberedState,[r]:e}})}restore(e="default"){if(!Q)return window.history.state?.rememberedState?.[e]}on(e,r){let i=s=>{let n=r(s);s.cancelable&&!s.defaultPrevented&&n===!1&&s.preventDefault()};return document.addEventListener(`inertia:${e}`,i),()=>document.removeEventListener(`inertia:${e}`,i)}};var ie={buildDOMElement(t){let e=document.createElement("template");e.innerHTML=t;let r=e.content.firstChild;if(!t.startsWith("<script "))return r;let i=document.createElement("script");return i.innerHTML=r.innerHTML,r.getAttributeNames().forEach(s=>{i.setAttribute(s,r.getAttribute(s)||"")}),i},isInertiaManagedElement(t){return t.nodeType===Node.ELEMENT_NODE&&t.getAttribute("inertia")!==null},findMatchingElementIndex(t,e){let r=t.getAttribute("inertia");return r!==null?e.findIndex(i=>i.getAttribute("inertia")===r):-1},update:T(function(t){let e=t.map(i=>this.buildDOMElement(i));Array.from(document.head.childNodes).filter(i=>this.isInertiaManagedElement(i)).forEach(i=>{let s=this.findMatchingElementIndex(i,e);if(s===-1){i?.parentNode?.removeChild(i);return}let n=e.splice(s,1)[0];n&&!i.isEqualNode(n)&&i?.parentNode?.replaceChild(n,i)}),e.forEach(i=>document.head.appendChild(i))},1)};function Y(t,e,r){let i={},s=0;function n(){let c=s+=1;return i[c]=[],c.toString()}function u(c){c===null||Object.keys(i).indexOf(c)===-1||(delete i[c],l())}function f(c,v=[]){c!==null&&Object.keys(i).indexOf(c)>-1&&(i[c]=v),l()}function b(){let c=e(""),v={...c?{title:`<title inertia="">${c}</title>`}:{}},R=Object.values(i).reduce((d,p)=>d.concat(p),[]).reduce((d,p)=>{if(p.indexOf("<")===-1)return d;if(p.indexOf("<title ")===0){let y=p.match(/(<title [^>]+>)(.*?)(<\/title>)/);return d.title=y?`${y[1]}${e(y[2])}${y[3]}`:p,d}let V=p.match(/ inertia="[^"]+"/);return V?d[V[0]]=p:d[Object.keys(d).length]=p,d},v);return Object.values(R)}function l(){t?r(b()):ie.update(b())}return l(),{forceUpdate:l,createProvider:function(){let c=n();return{update:v=>f(c,v),disconnect:()=>u(c)}}}}import h from"nprogress";var Z=null;function oe(t){document.addEventListener("inertia:start",ne.bind(null,t)),document.addEventListener("inertia:progress",se),document.addEventListener("inertia:finish",ae)}function ne(t){Z=setTimeout(()=>h.start(),t)}function se(t){h.isStarted()&&t.detail.progress?.percentage&&h.set(Math.max(h.status,t.detail.progress.percentage/100*.9))}function ae(t){if(clearTimeout(Z),h.isStarted())t.detail.visit.completed?h.done():t.detail.visit.interrupted?h.set(0):t.detail.visit.cancelled&&(h.done(),h.remove());else return}function le(t){let e=document.createElement("style");e.type="text/css",e.textContent=`
    #nprogress {
      pointer-events: none;
    }

    #nprogress .bar {
      background: ${t};

      position: fixed;
      z-index: 1031;
      top: 0;
      left: 0;

      width: 100%;
      height: 2px;
    }

    #nprogress .peg {
      display: block;
      position: absolute;
      right: 0px;
      width: 100px;
      height: 100%;
      box-shadow: 0 0 10px ${t}, 0 0 5px ${t};
      opacity: 1.0;

      -webkit-transform: rotate(3deg) translate(0px, -4px);
          -ms-transform: rotate(3deg) translate(0px, -4px);
              transform: rotate(3deg) translate(0px, -4px);
    }

    #nprogress .spinner {
      display: block;
      position: fixed;
      z-index: 1031;
      top: 15px;
      right: 15px;
    }

    #nprogress .spinner-icon {
      width: 18px;
      height: 18px;
      box-sizing: border-box;

      border: solid 2px transparent;
      border-top-color: ${t};
      border-left-color: ${t};
      border-radius: 50%;

      -webkit-animation: nprogress-spinner 400ms linear infinite;
              animation: nprogress-spinner 400ms linear infinite;
    }

    .nprogress-custom-parent {
      overflow: hidden;
      position: relative;
    }

    .nprogress-custom-parent #nprogress .spinner,
    .nprogress-custom-parent #nprogress .bar {
      position: absolute;
    }

    @-webkit-keyframes nprogress-spinner {
      0%   { -webkit-transform: rotate(0deg); }
      100% { -webkit-transform: rotate(360deg); }
    }
    @keyframes nprogress-spinner {
      0%   { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  `,document.head.appendChild(e)}function ee({delay:t=250,color:e="#29d",includeCSS:r=!0,showSpinner:i=!1}={}){oe(t),h.configure({showSpinner:i}),r&&le(e)}function te(t){let e=t.currentTarget.tagName.toLowerCase()==="a";return!(t.target&&(t?.target).isContentEditable||t.defaultPrevented||e&&t.which>1||e&&t.altKey||e&&t.ctrlKey||e&&t.metaKey||e&&t.shiftKey)}var Je=new N;export{A as Method,Y as createHeadManager,g as hrefToUrl,F as mergeDataIntoQueryString,Je as router,ee as setupProgress,te as shouldIntercept,x as urlWithoutHash};
//# sourceMappingURL=index.esm.js.map
